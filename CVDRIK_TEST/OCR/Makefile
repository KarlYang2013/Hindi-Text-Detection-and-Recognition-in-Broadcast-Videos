# Write The Main Code Name Here Without Any Extensions

include customMake

# Spcify Compiler
ifeq ($(OPTION), 1)
#CC = g++ -O3 -funroll-all-loops
CC = g++ -g -O3 -funroll-all-loops -I $(OPENCV_PATH)include/opencv -L $(OPENCV_PATH)lib -lopencv_core -lopencv_imgproc -lopencv_highgui -lopencv_ml -lopencv_video -lopencv_features2d -lopencv_calib3d -lopencv_objdetect -lopencv_contrib -lopencv_legacy -lopencv_flann -lopencv_nonfree -lgsl -lgslcblas
#CC = g++ -O3 -funroll-all-loops
else
ifeq ($(OPTION), 2)
CC = /opt/intel/cc/9.1.042/bin/icpc -O3 -static -ipo -axN -prefetch -unroll -prof_use
else
CC = /opt/intel_cc_80/bin/icpc -fast -tpp2 -unroll -IPF_fma -prof_use
endif
endif

# Write The Input Path for Header Files and Objects
INPUT_PATH = ../../CVDRIK/
OPENCV_PATH = /usr/local/

# Specify Headers : The ".h" Files for your Library 
HEADERS = $(INPUT_PATH)CVDRIKMisc/CVDRIKMisc.h \
			$(INPUT_PATH)CVDRIKTextRecognition/CVDRIKTextRecognition.h \
			$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h \
			$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKImageProcessing.h \


			
# Specify OpenCV Headers : The ".h" Files for Including OpenCV Library
OPENCV_HEADERS = $(OPENCV_PATH)include/opencv/cv.h \
				 $(OPENCV_PATH)include/opencv/cvaux.h \
				 $(OPENCV_PATH)include/opencv/cxcore.h \
				 $(OPENCV_PATH)include/opencv/highgui.h \
				 $(OPENCV_PATH)include/opencv2/core/core.hpp \
				 $(OPENCV_PATH)include/opencv2/nonfree/features2d.hpp \
				 $(OPENCV_PATH)include/gsl/gsl_vector_float.h \
				 $(OPENCV_PATH)include/gsl/gsl_histogram.h \
				 $(OPENCV_PATH)include/gsl/gsl_sort_vector.h \
				 $(OPENCV_PATH)include/gsl/gsl_math.h \
				 $(OPENCV_PATH)include/gsl/gsl_vector.h \
				 
											
# Specify Objects : The ".o" Files Generated by Compiling the ".cpp" Files
OBJECTS = $(INPUT_PATH)CVDRIKMisc/CVDRIKMisc.o \
		$(INPUT_PATH)CVDRIKTextRecognition/CVDRIKTextRecognition.o \
		$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKCORNERDETECT.o\
		$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKIPFeature.o \
		$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKIPCCA.o\
		$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelByteImage.o \
		$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelFloatImage.o \
		$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelIntImage.o \
		$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKIplImagePyramid.o \
		$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelFloatImagePyramid.o \

				
		  
# Compilation of the Main Code
ifneq ($(MAKECMDGOALS), clean)
$(MAKECMDGOALS) : $(MAKECMDGOALS).o $(OBJECTS)
	$(CC) -o $(MAKECMDGOALS) -lm $(MAKECMDGOALS).o $(OBJECTS)  -L $(OPENCV_PATH)lib -lopencv_core -lopencv_imgproc -lopencv_highgui -lopencv_ml -lopencv_video -lopencv_features2d -lopencv_calib3d -lopencv_objdetect -lopencv_contrib -lopencv_legacy -lopencv_flann -lopencv_nonfree -lgsl -lgslcblas

# Main Code Object File
$(MAKECMDGOALS).o : $(MAKECMDGOALS).cpp $(HEADERS) $(OPENCV_HEADERS)
	$(CC) -c $(MAKECMDGOALS).cpp 
endif

# Object File for Miscelleneous Functions
$(INPUT_PATH)CVDRIKMisc/CVDRIKMisc.o : $(patsubst %.o, %.cpp, $@) $(patsubst %.o, %.h, $@)
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
# Object File for Text Recognition Functions
$(INPUT_PATH)CVDRIKTextRecognition/CVDRIKTextRecognition.o : $(patsubst %.o, %.cpp, $@) $(patsubst %.o, %.h, $@)
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
# Object File for Image Processing Function : Image Feature Extraction
$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKCORNERDETECT.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKImageProcessing/CVDRIKImageProcessing.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
					
# Object File for Image Processing Function : Image Feature Extraction
$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKIPFeature.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKImageProcessing/CVDRIKImageProcessing.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@

# Object File for Image Processing Function : Image Feature Extraction
$(INPUT_PATH)CVDRIKImageProcessing/CVDRIKIPCCA.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKImageProcessing/CVDRIKImageProcessing.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
	
# Object File for Multiple Channel Image Functions : Multiple Channel Byte Image
$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelByteImage.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
# Object File for Multiple Channel Image Functions : Multiple Channel Float Image
$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelFloatImage.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
# Object File for Multiple Channel Image Functions : Multiple Channel Integer Image
$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelIntImage.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
# Object File for Multiple Channel Image Functions : IplImage Pyramid
$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKIplImagePyramid.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	
	
	
# Object File for Multiple Channel Image Functions : Multi-Channel Float Image Pyramid
$(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelFloatImagePyramid.o : $(patsubst %.o, %.cpp, $@) $(INPUT_PATH)CVDRIKMultiChannelImage/CVDRIKMultiChannelImage.h
	$(CC) -c $(patsubst %.o, %.cpp, $@) -o $@
	

	
.PHONY : clean
clean :
	rm -f $(OBJECTS) *.o
